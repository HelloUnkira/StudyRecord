#include "SGui_Kernel.h"
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
/* 适配层,通配事件表,一个或多个类型的事件归属于一个特定的事件集合 */
static struct {
    SGui_EventCallback   Callback;
    SGui_EventQueueTable Type;
} EventTable[SGui_EventType_All] = {
    /* 事件,响应回调,从属事件集合 */
    [SGui_EventType_Animation] = {SGui_EventAnimationExecute, SGui_EventQueue_Main},
};
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
uint32_t SGui_EventExecute(SGui_Event *Event)
{
    if (Event->EventType < SGui_EventType_All)
        return EventTable[Event->EventType].Callback(Event);
        return SGui_EventStatus_None;
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
uint32_t SGui_EventGetEventQueueType(SGui_Event *Event)
{
    return EventTable[Event->EventType].Type;
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
static void (*EventQueueSyncLock)(uint32_t   EventQueueType) = NULL;
static void (*EventQueueSyncUnlock)(uint32_t EventQueueType) = NULL;
static void (*EventQueueSyncNotify)(void)                    = NULL;
static void (*EventQueueSyncWait)(void)                      = NULL;
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
/* 这里为了保持统一性做了一次额外适配(表面上而言可以不用) */
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
static void SGui_EventAdaptorQueueSyncLock(uint32_t EventQueueType)
{
    if (EventQueueSyncLock != NULL)
        EventQueueSyncLock(EventQueueType);
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
static void SGui_EventAdaptorQueueSyncUnlock(uint32_t EventQueueType)
{
    if (EventQueueSyncUnlock != NULL)
        EventQueueSyncUnlock(EventQueueType);
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
static void SGui_EventAdaptorQueueSyncNotify(void)
{
    if (EventQueueSyncNotify != NULL)
        EventQueueSyncNotify();
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
void SGui_EventAdaptorQueueSyncWait(void)
{
    if (EventQueueSyncWait != NULL)
        EventQueueSyncWait();
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
void SGui_EventAdaptorQueueSyncRegister(void (*Lock)(uint32_t Index),
                                        void (*Unlock)(uint32_t Index),
                                        void (*Notify)(void),
                                        void (*Wait)(void))
{
    EventQueueSyncLock      = Lock;
    EventQueueSyncUnlock    = Unlock;
    EventQueueSyncNotify    = Notify;
    EventQueueSyncWait      = Wait;
    
    SGui_EventQueueSyncRegister(SGui_EventAdaptorQueueSyncLock,
                                SGui_EventAdaptorQueueSyncUnlock,
                                SGui_EventAdaptorQueueSyncNotify);
}
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
