#ifndef HASH_TABLE_H
#define HASH_TABLE_H
//C std lib
#include <stdint.h>
#include <stdbool.h>
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
#include "List.h"
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
/* 从当前节点节点地址获得它的所有者地址(编译时解析) */
#define HT_GetOwner(Type, Member, MemberAddress)    \
    ((Type *)((uint8_t *)(MemberAddress) - ((uint64_t) &((Type *)0)->Member)))
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
typedef struct HashTable_Node {
    SL_Node Node;
} HT_Node;
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
typedef struct HashTable_Nodes {
    SL_List Head;
    SL_List Tail;
} HT_Nodes;
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
typedef struct HashTable_Table {
    void    *Parameter1[3];
    uint32_t Parameter2;
} HT_Table;
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
typedef uint32_t (*HT_HashFunction)(HT_Node *Node);
typedef bool     (*HT_IsEqual)(HT_Node *Node1, HT_Node *Node2);
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
void HT_Table_SetZone(HT_Table *Table, HT_Nodes *Array, uint32_t Length);
void HT_Table_Set(HT_Table *Table, HT_HashFunction HashFunction, HT_IsEqual IsEqual);
void HT_Node_Add(HT_Table *Table, HT_Node *Node);
void HT_Node_Remove(HT_Table *Table, HT_Node *Node);
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
/* 通过特性值匹配的假节点获得真节点,不存在则证明未在表中 */
HT_Node * HT_Node_Search(HT_Table *Table, HT_Node *Node);
/*************************************************************************************************/
/*************************************************************************************************/
/*************************************************************************************************/
#endif
